<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Wazuh SSH Brute-Force Detection Lab</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="container">
    <h1>Wazuh SSH Brute-Force Detection Lab</h1>
    <p><strong>Date:</strong> May 15, 2025</p>

    <h2> Objective</h2>
    <p>Simulate and analyze SSH brute-force attacks on a cloud-hosted Linux server using Wazuh for threat detection, log analysis, and response in a Level 1 SOC environment.</p>

    <h2> Environment</h2>
    <ul>
      <li>Ubuntu VM hosted in Microsoft Azure</li>
      <li>Wazuh Manager + Agent</li>
      <li>OpenSearch Dashboard (Kibana-style interface)</li>
      <li>Firewall configuration and Fail2Ban</li>
    </ul>

    <h2> Analysis Summary</h2>
    <ul>
      <li><strong>Technique:</strong> T1110.001 – Brute Force: Password Guessing</li>
      <li><strong>Tactic:</strong> Initial Access</li>
      <li><strong>Rule IDs Triggered:</strong> 5715 (SSH authentication failures)</li>
      <li><strong>Source IPs:</strong> Primarily from China, Russia, and the U.S. (obfuscated for privacy)</li>
    </ul>

    <h2> Defensive Measures Implemented</h2>
    <ul>
      <li><strong>SSH Hardening</strong></li>
  <p>To limit SSH access, I configured the SSH daemon (<code>sshd_config</code>) to allow only a specific user. This significantly reduced the attack surface and ensured that only the designated user account could initiate a connection. Restarting the SSH service applied the change immediately without disrupting other services.</p>

  <li><strong>Firewall Rules (UFW)</strong></li>
  <p>I used Ubuntu’s built-in Uncomplicated Firewall (UFW) to allow SSH access from only a single trusted IP address while blocking all other SSH traffic. This prevented further brute-force attempts from unknown sources while still maintaining administrative access.</p>

  <li><strong>Fail2Ban Setup</strong></li>
  <p>To automate the blocking of repeated login failures, I installed and enabled Fail2Ban. It monitored SSH logs and dynamically banned IPs after a specified number of failed attempts. This acted as a secondary layer of defense and reduced the volume of repeated intrusion attempts.</p>

    </ul>

    <h2> Results</h2>
    <ul>
      <li>Brute-force attempts significantly reduced post-hardening</li>
      <li>Wazuh continued to alert on failed attempts and block malicious IPs</li>
      <li>Custom logging maintained using Google Sheets</li>
    </ul>

    <h2> Key Takeaways</h2>
    <ul>
      <li>Real-time log analysis helps identify early-stage attacks</li>
      <li>Wazuh is a powerful, open-source SIEM for SOC operations</li>
      <li>Firewall and user restrictions are effective for SSH hardening</li>
      <li>Mapped incidents to MITRE ATT&CK framework for better context</li>
    </ul>

    <h2> Project Artifacts</h2>
    <ul>
      <li><a href="https://docs.google.com/spreadsheets/d/your-sheet-link" target="_blank">Inbound SSH Attack Activity Log (Google Sheets)</a></li>
      <li><a href="images/ssh-attack-timeline.png" target="_blank">Timeline of Alerts (Image)</a></li>
    </ul>

    <p> This project strengthened my skills in security monitoring, Linux hardening, and detection engineering. It also reflects my proactive learning in building a virtual SOC lab using Wazuh as a free and open-source SIEM solution.</p>
  </div>
</body>
</html>
